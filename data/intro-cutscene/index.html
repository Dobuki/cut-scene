<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- METADATA -->
    <!-- version: aa521fed1f44ec90ca35d28e9e3ba355cc292efa84b2cd7659ae128b4a133876 -->
    <script>
      function ensureSlash(url) {
        url = url.split("?")[0].split("#")[0];
        if (!url.endsWith("/")) {
          return url + "/";
        }
        return url;
      }
      const canonicalUrl = ensureSlash("https://cutscene.dobuki.net/data/intro-cutscene");
      if (canonicalUrl !== ensureSlash(window.location.href)) {
        fetch(canonicalUrl).then(async (result) => {
          if (!result.ok) {
            return;
          }
          const text = await result.text();
          if (text.includes("version: aa521fed1f44ec90ca35d28e9e3ba355cc292efa84b2cd7659ae128b4a133876")) {
            console.log("canonical url https://cutscene.dobuki.net/data/intro-cutscene is ready");
            window.location.href = canonicalUrl;
          }
        }).catch(() => {
          console.log("canonical url https://cutscene.dobuki.net/data/intro-cutscene not ready");
        });
      }
      window.canonicalUrl = canonicalUrl;
      window.canonicalVersion = "aa521fed1f44ec90ca35d28e9e3ba355cc292efa84b2cd7659ae128b4a133876";
    </script>
    <title>The Story of the Supernatural power troll</title>
    <meta name="description" content="Knight Exposito arrives at the castle" />
    <meta name="keywords" content="cutscene" />
    <meta name="author" content="@jacklehamster" />
    <meta property="og:title" content="The Story of the Supernatural power troll" />
    <meta property="og:description" content="Knight Exposito arrives at the castle" />
    <meta property="og:image" content="https://art.dobuki.net/power-troll/cutscene/cutscene1.png" />
    <meta property="og:url" content="https://cutscene.dobuki.net/data/intro-cutscene" />
    <meta property="og:type" content="website" />
    <meta property="og:site_name" content="The Story of the Supernatural power troll" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="The Story of the Supernatural power troll" />
    <meta name="twitter:description" content="Knight Exposito arrives at the castle" />
    <meta name="twitter:image" content="https://art.dobuki.net/power-troll/cutscene/cutscene1.png" />
    <meta name="twitter:site" content="@jacklehamster" />
    <meta name="twitter:creator" content="@jacklehamster" />
    <link rel="canonical" href="https://cutscene.dobuki.net/data/intro-cutscene" />
    <link
      rel="icon"
      href="https://cutscene.dobuki.net/favicon.ico"
      type="image/x-icon"
    />
    <link
      rel="shortcut icon"
      href="https://cutscene.dobuki.net/favicon.ico"
      type="image/x-icon"
    />
    <link
      rel="icon"
      href="https://art.dobuki.net/images/dobuki.png"
      type="image/png"
    />
    <link
      rel="apple-touch-icon"
      href="https://art.dobuki.net/images/dobuki.png"
    />
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "CreativeWork",
        "name": "The Story of the Supernatural power troll",
        "description": "Knight Exposito arrives at the castle",
        "url": "https://cutscene.dobuki.net/data/intro-cutscene",
        "image": {
          "@type": "ImageObject",
          "url": "https://art.dobuki.net/power-troll/cutscene/cutscene1.png",
          "width": 1000,
          "height": 600
        },
        "publisher": {
          "@type": "Organization",
          "name": "Dobuki Studio",
          "logo": {
            "@type": "ImageObject",
            "url": "https://art.dobuki.net/images/dobuki.png",
            "width": 600,
            "height": 600
          }
        }
      }
    </script>  
  <!-- METADATA -->
    <!-- CUTSCENE -->
    <script>
      window.generatedCutscene = true;
    </script>
    <script type="application/json" id="cutscene-data">
    {
 "id": "intro-cutscene",
 "scenes": [
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene1.png",
   "text": "Knight Exposito arrives at the castle",
   "repeat": false,
   "fade": true,
   "voice": "Daniel"
  },
  {
   "text": "to meet with the powerful wizard, Merlot the flavorful"
  },
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene2.png",
   "text": "\"Step aside, vile troll!\", shouts the knight in shiny armor.",
   "audio": "https://art.dobuki.net/audio/trumpet.mp3",
   "repeat": false,
   "fade": true
  },
  {
   "text": "\"I was summoned by Merlot, I'm here on an important mission\""
  },
  {
   "text": "\"Surrender, if you value your miserable life, you despicable troll\""
  },
  {
   "text": "Perplexed, the Troll responds."
  },
  {
   "text": "\"Go ahead, I'm not guarding the place\", responds the troll.",
   "voice": "Junior"
  },
  {
   "text": "\"Merlot merely asked me to pose half naked in front of the gate\""
  },
  {
   "text": "\"So just pass through, and spare me the disparaging comment!\""
  },
  {
   "text": "\"Thank you, repulsive troll. You may return to your meager post.\",\nresponds the Knight.",
   "voice": "Daniel"
  },
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene3.png",
   "text": "\"I have arrived, O Powerful Wizard.\", says the Knight.",
   "audio": "https://art.dobuki.net/audio/darkness.mp3",
   "repeat": true,
   "fade": true,
   "wait": 1000
  },
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene4.png",
   "text": "\"Yes, I, Merlot the delectable, was waiting for you.\", responds Merlot.",
   "voice": "Ralph"
  },
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene5.png",
   "text": "\"What is it you desire, O Merlot the succulent?\", says the Knight",
   "voice": "Daniel"
  },
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene7.png",
   "text": "\"I will share my plan with you.\", says Merlot",
   "fade": true,
   "voice": "Ralph"
  },
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene6.png",
   "text": "\"Please do so, messire.\", says the Knight",
   "voice": "Daniel"
  },
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene7.png",
   "text": "\"Exposito, knight with a crispy clean armor.\", says Merlot",
   "voice": "Ralph"
  },
  {
   "text": "\"Do you know what is... a gamejam?\""
  },
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene6.png",
   "text": "\"No messire. Please enlighten me.\", says the Knight",
   "voice": "Daniel"
  },
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene10.png",
   "text": "\"A gamejam... is a jam... in which you have to make a game!\"",
   "fade": true,
   "voice": "Ralph"
  },
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene9.png",
   "text": "\"A game, sir?\", asks the Knight",
   "voice": "Daniel"
  },
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene10.png",
   "text": "\"That's right\", responds Merlot",
   "voice": "Ralph"
  },
  {
   "text": "\"We are given a theme, and we must use it to make a game!\""
  },
  {
   "text": "\"This time... the theme is...\""
  },
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene12.png",
   "text": "\"POWER\"",
   "fade": true
  },
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene9.png",
   "text": "\"Power, messire?\", asks the Knight",
   "fade": true,
   "voice": "Daniel"
  },
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene10.png",
   "text": "\"That's right. The theme is POWER\"",
   "voice": "Ralph"
  },
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene9.png",
   "text": "\"It is a perfect theme for you, Sir Merlot the palatable\"",
   "voice": "Daniel"
  },
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene10.png",
   "text": "\"Yes it is. But do you know, Exposito,\nwhat I am going to do with the theme?\"",
   "voice": "Ralph"
  },
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene9.png",
   "text": "\"No messire. I am completely mystified by your plan sir.\"",
   "voice": "Daniel"
  },
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene10.png",
   "text": "\"Ok knight. Let me tell you, but do not repeat to anyone.\"",
   "voice": "Ralph"
  },
  {
   "text": "\"This must be kept secret between you and me.\""
  },
  {
   "text": "\"What I am going to do with the theme, is...\""
  },
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene12.png",
   "text": "\"SUMMON A SUPERNATURAL POWER TROLL!\"",
   "fade": true
  },
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene13.png",
   "text": "\"A power troll? messire\", says the knight",
   "voice": "Daniel"
  },
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene12.png",
   "text": "\"That's right, a supernatural power troll\", says Merlot",
   "voice": "Ralph"
  },
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene13.png",
   "text": "\"A supernatural power troll.\", says the knight",
   "voice": "Daniel"
  },
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene12.png",
   "text": "\"Yes. A super natural power troll.\", says Merlot",
   "voice": "Ralph"
  },
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene9.png",
   "text": "\"But messire\", asks the Knight",
   "fade": true,
   "voice": "Daniel"
  },
  {
   "text": "\"Where will you find a creature willing to risk their miserable life...\""
  },
  {
   "text": "\"...to become a super natural power troll?\""
  },
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene10.png",
   "text": "\"We must find a troll\", responds Merlot",
   "voice": "Ralph"
  },
  {
   "text": "\"A troll that is naïve, feeble minded, gullible...\""
  },
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene12.png",
   "text": "\"MEDIOCRE, a PATSY, dupe, an absolute SUCKER...\"",
   "fade": true
  },
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene13.png",
   "text": "\"The most MISERABLE, DISMAL, WRETCHED,\nCRESTFALLEN troll one can find!...\""
  },
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene14.png",
   "text": "\"Shhh... quiet! I hear someone coming!\""
  },
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene15.png",
   "text": "\"Greeting, sir Merlot the Indulgent.\", whispers a gentle creature",
   "fade": true,
   "voice": "Junior"
  },
  {
   "text": "\"I couldn't help but hear you call my name out loud.\""
  },
  {
   "text": "\"Is there something you desire from me, O Merlot the Opulent.\""
  },
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene11.png",
   "text": "\"Oh yes, the troll... I overlooked this one.\", says Merlot",
   "fade": true,
   "voice": "Ralph"
  },
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene10.png",
   "text": "\"In fact, troll. I must say. You are the perfect candidate.\""
  },
  {
   "text": "\"I will bestow upon you, an important mission.\""
  },
  {
   "text": "\"You will infiltrate the human world, and you shall become...\""
  },
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene16.png",
   "text": "\"A SUPERNATURAL POWER TROLL! HAHAAAHAAaaa....\""
  },
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene15.png",
   "text": "\"The perfect creature for the mission...\"",
   "fade": true
  },
  {
   "bg": "https://art.dobuki.net/power-troll/cutscene/cutscene15.png",
   "text": "\"...go forth, venture into the human realm...\""
  },
  {
   "text": "\"...and become, the SUPERNATURAL POWER TROLL\""
  },
  {
   "text": "\"As you wish, sir Merlot.\", says the troll",
   "voice": "Junior"
  },
  {
   "text": "\"I will venture into the human realm.\""
  },
  {
   "text": "\"And become... the Super naturel power Troll!\""
  },
  {
   "text": "(WTH is a power troll?), ponders the troll.",
   "fade": true,
   "audio": "stop"
  }
 ],
 "speechReplacement": [
  [
   "WTH",
   "what the hell"
  ],
  [
   "HAHAAAHAAaaa",
   "ha ha ha!"
  ],
  [
   "messire",
   "messeer"
  ]
 ],
 "availableImages": [
  [
   "https://art.dobuki.net/power-troll/cutscene/cutscene1.png"
  ],
  [
   "https://art.dobuki.net/power-troll/cutscene/cutscene2.png"
  ],
  [
   "https://art.dobuki.net/power-troll/cutscene/cutscene3.png"
  ],
  [
   "https://art.dobuki.net/power-troll/cutscene/cutscene4.png"
  ],
  [
   "https://art.dobuki.net/power-troll/cutscene/cutscene5.png"
  ],
  [
   "https://art.dobuki.net/power-troll/cutscene/cutscene7.png"
  ],
  [
   "https://art.dobuki.net/power-troll/cutscene/cutscene6.png"
  ],
  [
   "https://art.dobuki.net/power-troll/cutscene/cutscene10.png"
  ],
  [
   "https://art.dobuki.net/power-troll/cutscene/cutscene9.png"
  ],
  [
   "https://art.dobuki.net/power-troll/cutscene/cutscene12.png"
  ],
  [
   "https://art.dobuki.net/power-troll/cutscene/cutscene13.png"
  ],
  [
   "https://art.dobuki.net/power-troll/cutscene/cutscene14.png"
  ],
  [
   "https://art.dobuki.net/power-troll/cutscene/cutscene15.png"
  ],
  [
   "https://art.dobuki.net/power-troll/cutscene/cutscene11.png"
  ],
  [
   "https://art.dobuki.net/power-troll/cutscene/cutscene16.png"
  ]
 ],
 "availableAudio": [
  [
   "https://art.dobuki.net/audio/trumpet.mp3"
  ],
  [
   "https://art.dobuki.net/audio/darkness.mp3"
  ]
 ],
 "author": "@jacklehamster",
 "title": "The Story of the Supernatural power troll",
 "externalLink": "https://www.dobuki.net",
 "lockKey": "83dc46f6e07662836b6f839616fec2dc1b4fcc11d2c54ef9810657103efcb96d"
}
    </script>
    <!-- CUTSCENE -->
    <style>
      @font-face {
        font-family: "Coffee";
        src: url(https://cutscene.dobuki.net/fonts/Gluten-Bold.otf)
          format("opentype");
        font-display: block;
      }
      @font-face {
        font-family: "Gameboy";
        src: url(https://cutscene.dobuki.net/fonts/early-gameboy.ttf)
          format("truetype");
        font-display: swap;
      }
      @font-face {
        font-family: "Speech";
        src: url(https://cutscene.dobuki.net/fonts/cat-comic.ttf)
          format("truetype");
        font-display: swap;
      }
      html::-webkit-scrollbar {
        display: none;
      }
      body {
        margin: 0;
        background-color: #0e0007;
        -webkit-user-select: none; /* Safari */
        -moz-user-select: none; /* Firefox */
        -ms-user-select: none; /* IE10+/Edge */
        user-select: none; /* Standard */
      }
      .asi {
        font-family: Speech;
      }
      .title {
        margin: 0;
        padding: 0;
        text-shadow: #fc0 1px 0 10px;
        color: #cccccc;
        transition: all 0.5s;
        height: 100px;
        margin-top: 50px;
      }
      .author {
        margin: 0;
        padding: 0;
        color: #999999;
        transition: all 0.5s;
      }
      .cut-scene {
        margin: auto;
        width: 600px;
        height: 360px;
        cursor: pointer;
        background-repeat: no-repeat;
        background-position-x: center;
        background-position-y: center;
        display: flex;
        transition: opacity 1s;
        font-size: 16pt;
        -webkit-user-select: none; /* Safari */
        -moz-user-select: none; /* Firefox */
        -ms-user-select: none; /* IE10+/Edge */
        user-select: none; /* Standard */
        border-radius: 25px;
        /*background-image: url(https://art.dobuki.net/images/dobuki.png);*/
        background-size: 60%;
        font-family: Speech;
      }
      h4,
      h3,
      h2,
      h1 {
        margin: 5;
      }
      .important {
        font-weight: bold;
        color: black;
        text-transform: uppercase;
      }
      .container {
        border-radius: 25px;
        background-color: black;
        width: 600px;
        height: 360px;
        margin: auto;
        transition: all 0.5s;
      }
      .game-view {
        width: 100%;
        height: 100%;
      }
      .prompt-dialog {
        font-family: Speech;
        font-size: 16pt;
        background-color: #cccccc;
        padding: 20px 40px;
        border-radius: 10px;
        box-shadow: 5px 5px 10px 0 rgba(0, 0, 0, 0.5);
        text-align: center;
        cursor: move;
        position: absolute;
      }
      .prompt-text {
        pointer-events: none;
      }
      .prompt-button {
        width: 120px;
      }
      #press-key {
        transition: opacity 0.5s;
      }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako.min.js"></script>
    <script>
      window.cutsceneMode = true;
    </script>
    <script>
      async function fetchAndDecompress(url, backupUrl) {
        try {
          // Fetch the compressed file
          const response = await fetch(url);
          const compressedData = await response.arrayBuffer();

          // Decompress the file using pako (for Gzip)
          const decompressedData = pako.ungzip(new Uint8Array(compressedData));

          // Create a Blob from the decompressed data
          const blob = new Blob([decompressedData], {
            type: "application/javascript",
          });

          // Create a Blob URL
          return URL.createObjectURL(blob);
        } catch (err) {
          console.warn("Error fetching or decompressing file:", err);
          if (backupUrl) {
            const decompressedData = await fetch(backupUrl).then((response) =>
              response.blob()
            );
            // Create a Blob from the decompressed data
            const blob = decompressedData;

            // Create a Blob URL
            return URL.createObjectURL(blob);
          }
        }
      }
      var sourceUrlPromise = fetchAndDecompress(
        window.generatedCutscene
          ? "https://cutscene.dobuki.net/data/index.bin"
          : "dist/index.bin"
      );
    </script>
  </head>
  <body>
    <div
      id="prompter"
      style="display: none"
      onmousedown="event.stopPropagation()"
      onmouseup="event.stopPropagation()"
      onkeydown="event.stopPropagation()"
      onkeyup="event.stopPropagation()"
    >
      <div
        style="
          position: fixed;
          background-color: rgba(0, 0, 0, 0.5);
          z-index: 999;
          width: 100vw;
          height: 100vh;
          top: 0;
          left: 0;
        "
      >
        <div
          style="
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
          "
        >
          <div class="prompt-dialog">
            <div style="pointer-events: none">
              <label id="prompt-label" for="prompt-text">Enter text</label>
            </div>
            <div>
              <textarea
                style="
                  width: 300px;
                  height: 100px;
                  border-radius: 10px;
                  padding: 5px;
                "
                id="prompt-text"
                placeholder="Enter your text"
              ></textarea>
            </div>
            <div>
              <button type="button" id="prompt-button" class="prompt-button">
                OK
              </button>
              <button type="button" id="prompt-cancel" class="prompt-button">
                Cancel
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="press-key">
      <div style="width: 100%; text-align: center">
        <div id="container" class="container" style="margin-top: 10px">
          <h1 class="title"></h1>
          <h4 class="author"></h4>
          <div
            id="game-view"
            class="game-view"
            style="opacity: 0; display: none"
          ></div>
          <div class="cut-scene" id="cut-scene" style="opacity: 0">
            <div
              style="
                margin-bottom: 15px;
                display: inline-block;
                align-self: flex-end;
                background-color: #ffffffaa;
                text-align: center;
                width: 100%;
              "
            >
              Press space to start
            </div>
          </div>
          <div id="page" style="color: #999999"></div>
        </div>
      </div>
    </div>
  </body>
  <script id="cut-scene-code" type="module">
    const module = await import(await sourceUrlPromise);
    const {
      createSuperNaturalPowerTrollGame,
      newgrounds,
      prepareUrls,
      u,
      revoke,
      handleGamePad,
      fetchJsonFile,
      fetchUserJsonFile,
      listFiles,
      canPlayMP3,
      canPlayOGG,
      getAllOverlays,
      compress,
      extract,
    } = module;

    const cs = document.getElementById("cut-scene");
    cs.style.opacity = 1;
    let transitioning = false;

    let currentAudio;
    let audioPlaying;

    const keyDown = (e) => {
      switch (e.code) {
        case "Enter":
          startGame(0);
          break;
        case "Space":
          startGame(1);
          break;
      }
    };
    const onClick = () => {
      startGame();
    };

    const startGame = async () => {
      document.removeEventListener("keydown", keyDown);
      const cutSceneDiv = document.getElementById("cut-scene");
      cutSceneDiv.parentElement.removeChild(cutSceneDiv);

      const gameView = document.getElementById("game-view");
      const container = document.getElementById("container");
      container.style.width = "100vw";
      container.style.height = "100vh";
      container.style.borderRadius = "0px";
      container.style.marginTop = "0";
      gameView.style.display = "";

      document.querySelector(".title").style.opacity = 0;
      document.querySelector(".title").style.margin = 0;
      document.querySelector(".title").style.height = 0;

      document.querySelector(".author").style.opacity = 0;
      document.querySelector(".author").style.margin = 0;
      document.querySelector(".author").style.height = 0;

      document.querySelector("#press-key").style.opacity = 0;
      setTimeout(() => {
        document.querySelector("#press-key").style.opacity = 1;
      }, 800);

      const activatePlayer = () => {};
      const audioExt = "mp3";
      window.game = await createSuperNaturalPowerTrollGame(
        undefined,
        "save",
        undefined,
        gameView,
        async (url) => fetch(url).then((r) => r.text()),
        activatePlayer,
        audioExt,
        undefined,
        undefined,
        undefined,
        undefined,
        fetchUserJsonFile,
        async (message, defaultValue, options) => {
          return new Promise((resolve) => {
            const promptDialog = document.getElementById("prompter");
            const promptLabel = document.getElementById("prompt-label");
            const promptText = document.getElementById("prompt-text");
            const promptButton = document.getElementById("prompt-button");
            const promptCancel = document.getElementById("prompt-cancel");
            promptLabel.textContent = message;
            promptText.value = defaultValue;
            promptText.placeholder = options?.placeholder ?? "";
            promptDialog.style.display = "block";
            promptText.focus();
            promptText.select();
            const ok = () => {
              closePrompt();
              resolve(promptText.value);
            };
            const cancel = () => {
              closePrompt();
              resolve(null);
            };
            promptCancel.textContent = options?.cancelLabel ?? "Cancel";
            promptButton.addEventListener("click", ok);
            promptCancel.addEventListener("click", cancel);
            const closePrompt = () => {
              promptDialog.style.display = "none";
              promptButton.removeEventListener("click", ok);
              promptCancel.removeEventListener("click", cancel);
            };
          });
        },
        [],
        undefined,
        false,
        compress,
        extract,
        JSON.parse(document.querySelector("#cutscene-data").textContent),
        window.generatedCutscene
      );
    };

    document.addEventListener("keydown", keyDown);
    document.querySelector("#cut-scene").addEventListener("click", onClick);
    document.fonts.load('12pt "Gameboy"');

    {
      const dialog = document.querySelector(".prompt-dialog");
      let pointDown = null;
      const point = { x: 0, y: 0 };
      dialog.addEventListener("mousedown", (e) => {
        pointDown = { x: e.clientX, y: e.clientY };
        point.x = dialog.offsetLeft;
        point.y = dialog.offsetTop;
        e.stopPropagation();
      });
      dialog.addEventListener("mousemove", (e) => {
        if (e.buttons === 1 && e.target === dialog && pointDown) {
          const diffX = e.clientX - pointDown.x;
          const diffY = e.clientY - pointDown.y;
          dialog.style.left = `${point.x + diffX}px`;
          dialog.style.top = `${point.y + diffY}px`;
          e.stopPropagation();
        }
        if (!e.buttons) {
          pointDown = null;
        }
      });
    }

    {
      const targetPage = location.hash
        ? parseInt(location.hash.replace("#page-", ""))
        : undefined;

      function findBg(scenes, pageIndex) {
        for (let i = pageIndex; i >= 0; i--) {
          if (scenes[i].bg) {
            return scenes[i].bg;
          }
        }
      }

      const scenes = JSON.parse(
        document.querySelector("#cutscene-data").textContent
      ).scenes;
      const bg = findBg(scenes, targetPage ? targetPage - 1 : 0);
      if (bg) {
        document.querySelector("#cut-scene").style.backgroundImage =
          `url(${bg})`;
      }
      document.querySelector("#page").textContent = targetPage
        ? `Page ${targetPage} / ${scenes.length}`
        : "";
      document.querySelector(".title").textContent = document.title;
      document.querySelector(".author").textContent =
        document.querySelector("meta[name=author]").content;
    }
  </script>
</html>
